From e0b8ffe3099735fefd64973e6575c67ac0759be2 Mon Sep 17 00:00:00 2001
From: David Zeuthen <davidz@redhat.com>
Date: Tue, 15 May 2012 14:17:22 +0000
Subject: Bug 49842 â€“ Unhandled rootfs on bind mount

Don't ignore a mount just because if a subtree of the filesystem is
mounted. Because if we do this, we may wrongly conclude the device is
not mounted at all, which then means that it's visible in the desktop
UI and subject to automounting.

In the future, we may want a "a(ss) MountPointsFull" property that in
addition to the mount point also contains the subtree that is mounted
at said mountpoint.

https://bugs.freedesktop.org/show_bug.cgi?id=49842

Signed-off-by: David Zeuthen <davidz@redhat.com>
---
diff --git a/src/udisksmountmonitor.c b/src/udisksmountmonitor.c
index 43adaa5..36e1476 100644
--- a/src/udisksmountmonitor.c
+++ b/src/udisksmountmonitor.c
@@ -433,10 +433,6 @@ udisks_mount_monitor_get_mountinfo (UDisksMountMonitor  *monitor,
           continue;
         }
 
-      /* ignore mounts where only a subtree of a filesystem is mounted */
-      if (g_strcmp0 (encoded_root, "/") != 0)
-        continue;
-
       /* Temporary work-around for btrfs, see
        *
        *  https://bugzilla.redhat.com/show_bug.cgi?id=495152#c31
--
cgit v0.9.0.2-2-gbebe
