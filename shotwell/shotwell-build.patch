diff -aurN shotwell-0.11.2.orig/plugins/Makefile.plugin.mk shotwell-0.11.2/plugins/Makefile.plugin.mk
--- shotwell-0.11.2.orig/plugins/Makefile.plugin.mk	2011-09-22 23:12:46.853946770 +0200
+++ shotwell-0.11.2/plugins/Makefile.plugin.mk	2011-09-29 18:45:37.458983023 +0200
@@ -23,8 +23,8 @@
 PKGS := $(shell sed ':a;N;$$!ba;s/\n/ /g' ../shotwell-plugin-dev-1.0.deps) $(PKGS)
 
 # automatically include the shotwell-plugin-dev-1.0 package as a local dependency
-EXT_PKGS := $(PKGS) 
-PKGS := shotwell-plugin-dev-1.0 $(PKGS)
+EXT_PKGS := $(PKGS)
+PKGS := shotwell-plugin-dev-1.0 $(PKGS) $(PLUGIN_PKGS)
 
 # automatically include the Resources.vala common file
 SRC_FILES := ../common/Resources.vala $(SRC_FILES)
@@ -32,8 +32,8 @@
 CFILES := $(notdir $(SRC_FILES:.vala=.c))
 OFILES := $(notdir $(SRC_FILES:.vala=.o))
 
-CFLAGS := `pkg-config --print-errors --cflags $(EXT_PKGS)` -nostdlib -export-dynamic $(PLUGIN_CFLAGS)
-LDFLAGS := `pkg-config --print-errors --libs $(EXT_PKGS)` $(LDFLAGS)
+CFLAGS := `pkg-config --print-errors --cflags $(EXT_PKGS) $(PLUGIN_PKGS)` -nostdlib -export-dynamic $(PLUGIN_CFLAGS)
+LIBS := `pkg-config --print-errors --libs $(EXT_PKGS) $(PLUGIN_PKGS)`
 DEFINES := -D_VERSION='"$(PLUGINS_VERSION)"' -DGETTEXT_PACKAGE='"shotwell"'
 
 all: $(PLUGIN).so
@@ -54,7 +54,7 @@
 	$(CC) -c $(CFLAGS) $(DEFINES) -I../.. $(CFILES)
 
 $(PLUGIN).so: $(OFILES)
-	$(CC) $(CFLAGS) -Wl,--no-as-needed $(LDFLAGS) $(OFILES) -I../.. -shared -o $@
+	$(CC) $(CFLAGS) $(LDFLAGS) -shared $(OFILES) $(LIBS) -o $@
 
 .PHONY: cleantemps
 cleantemps:
diff -aurN shotwell-0.11.2.orig/plugins/shotwell-publishing/Makefile shotwell-0.11.2/plugins/shotwell-publishing/Makefile
--- shotwell-0.11.2.orig/plugins/shotwell-publishing/Makefile	2011-09-22 23:12:46.854946757 +0200
+++ shotwell-0.11.2/plugins/shotwell-publishing/Makefile	2011-09-29 18:42:02.802666596 +0200
@@ -1,7 +1,7 @@
 
 PLUGIN := shotwell-publishing
 
-PKGS := \
+PLUGIN_PKGS := \
 	gtk+-2.0 \
 	libsoup-2.4 \
 	libxml-2.0 \
diff -aurN shotwell-0.11.2.orig/plugins/shotwell-publishing-extras/Makefile shotwell-0.11.2/plugins/shotwell-publishing-extras/Makefile
--- shotwell-0.11.2.orig/plugins/shotwell-publishing-extras/Makefile	2011-09-22 23:12:46.854946757 +0200
+++ shotwell-0.11.2/plugins/shotwell-publishing-extras/Makefile	2011-09-29 18:42:16.622493824 +0200
@@ -1,7 +1,7 @@
 
 PLUGIN := shotwell-publishing-extras
 
-PKGS := \
+PLUGIN_PKGS := \
 	gtk+-2.0 \
 	libsoup-2.4 \
 	libxml-2.0 \
